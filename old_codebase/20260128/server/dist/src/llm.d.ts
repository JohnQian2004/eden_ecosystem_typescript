/**
 * LLM Module
 * Handles LLM query extraction and response formatting
 */
import type { MovieListing, TokenListing, LLMQueryResult, LLMResponse } from "./types";
/**
 * Initialize LLM module with dependencies
 */
export declare function initializeLLM(broadcastFn: (event: any) => void): void;
export declare const LLM_QUERY_EXTRACTION_PROMPT = "\nYou are Eden Core AI query processor.\nExtract service query from user input.\nReturn JSON only with: query (object with serviceType and filters), serviceType, confidence.\n\n\uD83D\uDEA8 CRITICAL: Distinguish between EDEN CHAT (workflow queries) and REGULAR TEXT CHAT (informational queries):\n\n- **EDEN CHAT (Workflow/Service Queries)**: These should trigger workflows\n  - Examples: \"book a movie\", \"buy movie tickets\", \"trade 2 SOL with TOKEN\", \"find a pharmacy\", \"buy TOKENA\"\n  - These are ACTION queries that request services\n  - Extract serviceType and filters for these queries\n\n- **REGULAR TEXT CHAT (Informational Queries)**: These should NOT trigger workflows\n  - Examples: \"how to messaging\", \"how eden works\", \"what is the garden of eden\", \"who eden works\", \"how do I use this\"\n  - These are INFORMATION queries that should be answered directly\n  - For these queries, return serviceType: \"informational\" and empty filters\n\nService types: \"movie\", \"dex\", or \"informational\" (for regular text chat)\n\nCRITICAL: Classify queries based on these rules:\n\nMOVIE SERVICE (serviceType: \"movie\"):\n- Keywords: \"movie\", \"ticket\", \"tickets\", \"cinema\", \"theater\", \"theatre\", \"film\", \"watch\", \"showtime\", \"show\", \"AMC\", \"Cinemark\", \"MovieCom\", \"cinema\", \"theater\"\n- Examples: \"buy movie tickets\", \"I want to watch a movie\", \"find movies\", \"movie tickets\", \"cinema tickets\", \"2 tickets\", \"buy 2 tickets\"\n- If user mentions \"ticket\" or \"tickets\" WITHOUT mentioning \"token\", \"TOKENA\", \"TOKENB\", \"DEX\", \"pool\", \"trade\", it's ALWAYS a movie query\n- If user says \"buy 2 tickets\" or \"I want 2 tickets\", it means 2 MOVIE TICKETS, not tokens\n- Extract filters: location, maxPrice, genre, time, showtime\n\nDEX TOKEN SERVICE (serviceType: \"dex\"):\n- Keywords: \"token\", \"TOKEN\", \"TOKENA\", \"TOKENB\", \"TOKENC\", \"DEX\", \"pool\", \"trade\", \"swap\", \"exchange\", \"buy token\", \"sell token\", \"token A\", \"token B\", \"SOL\", \"SOLANA\"\n- Examples: \"buy TOKEN\", \"buy TOKENA\", \"buy 2 TOKENA\", \"sell token A\", \"buy token with SOL\", \"DEX trade\", \"Trade 2 SOL with TOKEN\", \"swap SOL for TOKEN\"\n- CRITICAL CLASSIFICATION RULES (in priority order):\n  1. If user mentions \"TOKEN\" (with or without a letter) AND mentions \"SOL\" or \"SOLANA\" \u2192 ALWAYS DEX\n  2. If user mentions \"trade\" AND mentions \"TOKEN\" or \"SOL\" \u2192 ALWAYS DEX\n  3. If user mentions \"DEX\" or \"pool\" \u2192 ALWAYS DEX\n  4. If user mentions \"token\" (lowercase) AND a token symbol (TOKEN, TOKENA, TOKENB, etc.) \u2192 ALWAYS DEX\n  5. If user mentions \"swap\" or \"exchange\" with \"TOKEN\" or \"SOL\" \u2192 ALWAYS DEX\n- Extract: tokenSymbol, baseToken, action (BUY/SELL), tokenAmount, baseAmount, maxPrice\n\nFor movie queries:\nExample: {\"query\": {\"serviceType\": \"movie\", \"filters\": {\"location\": \"Baltimore\", \"maxPrice\": 10}}, \"serviceType\": \"movie\", \"confidence\": 0.95}\nExample: {\"query\": {\"serviceType\": \"movie\", \"filters\": {\"maxPrice\": \"best\"}}, \"serviceType\": \"movie\", \"confidence\": 0.95}\nExample: {\"query\": {\"serviceType\": \"movie\", \"filters\": {}}, \"serviceType\": \"movie\", \"confidence\": 0.95}\n\nFor DEX token trading queries (BUY/SELL tokens):\n- tokenSymbol: The token being bought/sold (e.g., \"TOKENA\", \"TOKENB\", \"TOKENC\", \"Token A\", \"TOKEN\")\n  * If user says \"BUY token A\" or \"token A\" or \"TOKENA\", tokenSymbol = \"TOKENA\"\n  * If user says \"BUY token B\" or \"token B\" or \"TOKENB\", tokenSymbol = \"TOKENB\"\n  * If user says \"SOLANA token A\" or \"Trade X SOL with TOKENA\", tokenSymbol = \"TOKENA\" (token A is what's being traded)\n  * If user says \"Trade X SOL with TOKENB\", tokenSymbol = \"TOKENB\"\n  * If user says \"TOKEN\" without a letter (A, B, C, etc.), tokenSymbol = \"TOKEN\"\n  * CRITICAL: \"TOKENA\", \"TOKENB\", \"TOKENC\" are valid token symbols - extract them exactly as written\n- baseToken: The currency used to buy/sell (e.g., \"SOL\", \"USDC\", \"SOLANA\")\n  * If user says \"BUY with SOL\" or \"SOLANA token A\", baseToken = \"SOL\" (SOL is the payment currency)\n- Extract action: \"BUY\" or \"SELL\"\n- Extract tokenAmount if user specifies token quantity (e.g., \"buy 2 TOKEN\" means tokenAmount = 2)\n- Extract baseAmount if user specifies base token quantity (e.g., \"Trade 2 SOL with TOKEN\" means baseAmount = 2, \"Trade 2 SOL with TOKENA\" means baseAmount = 2 and tokenSymbol = \"TOKENA\")\n- CRITICAL: When user says \"Trade X SOL with TOKENA\" or \"Trade X SOL with TOKENB\", the number X is ALWAYS the baseAmount (amount of SOL to spend), NOT the tokenAmount\n- Extract maxPrice if specified (e.g., \"1 Token/SOL\" means price <= 1)\n\n\uD83D\uDEA8 CRITICAL QUANTITY EXTRACTION RULES (MUST FOLLOW):\n- Pattern: \"Trade [NUMBER] SOL with TOKEN\" \u2192 baseAmount = [NUMBER], tokenSymbol = \"TOKEN\", baseToken = \"SOL\", action = \"BUY\"\n  * Example: \"Trade 2 SOL with TOKEN\" \u2192 baseAmount = 2 (NOT tokenAmount = 2!)\n  * Example: \"Trade 5 SOL with TOKEN\" \u2192 baseAmount = 5\n  * Example: \"Trade 10 SOL with TOKEN\" \u2192 baseAmount = 10\n  * THE NUMBER BEFORE \"SOL\" IS ALWAYS THE baseAmount (quantity of SOL to spend)\n- Pattern: \"Trade [NUMBER] SOL with TOKENA\" \u2192 baseAmount = [NUMBER], tokenSymbol = \"TOKENA\", baseToken = \"SOL\", action = \"BUY\"\n  * Example: \"Trade 2 SOL with TOKENA\" \u2192 baseAmount = 2, tokenSymbol = \"TOKENA\"\n  * Example: \"Trade 3 SOL with TOKENA\" \u2192 baseAmount = 3, tokenSymbol = \"TOKENA\"\n- Pattern: \"Trade [NUMBER] SOL with TOKENB\" \u2192 baseAmount = [NUMBER], tokenSymbol = \"TOKENB\", baseToken = \"SOL\", action = \"BUY\"\n- Pattern: \"Buy TOKEN with [NUMBER] SOL\" \u2192 baseAmount = [NUMBER], tokenSymbol = \"TOKEN\", baseToken = \"SOL\", action = \"BUY\"\n- Pattern: \"Swap [NUMBER] SOL for TOKEN\" \u2192 baseAmount = [NUMBER], tokenSymbol = \"TOKEN\", baseToken = \"SOL\", action = \"BUY\"\n- Pattern: \"Buy [NUMBER] TOKEN\" \u2192 tokenAmount = [NUMBER], tokenSymbol = \"TOKEN\", action = \"BUY\" (number refers to tokens, not SOL)\n- Pattern: \"Buy [NUMBER] TOKENA\" \u2192 tokenAmount = [NUMBER], tokenSymbol = \"TOKENA\", action = \"BUY\" (number refers to tokens, not SOL)\n\nCRITICAL: Understanding quantity specifications:\n- \"Trade 2 SOL with TOKEN\" or \"Trade 2 SOL with TOKENA\" \u2192 baseAmount = 2, tokenSymbol = \"TOKEN\" or \"TOKENA\", action = \"BUY\" (user wants to spend 2 SOL to buy tokens)\n- \"Buy TOKEN with 2 SOL\" or \"Buy TOKENA with 2 SOL\" \u2192 baseAmount = 2, tokenSymbol = \"TOKEN\" or \"TOKENA\", action = \"BUY\"\n- \"Swap 2 SOL for TOKEN\" or \"Swap 2 SOL for TOKENA\" \u2192 baseAmount = 2, tokenSymbol = \"TOKEN\" or \"TOKENA\", action = \"BUY\"\n- \"Buy 2 TOKEN\" or \"Buy 2 TOKENA\" \u2192 tokenAmount = 2, tokenSymbol = \"TOKEN\" or \"TOKENA\", action = \"BUY\" (user wants 2 tokens)\n- When baseAmount is specified, the system will calculate tokenAmount from the pool price\n- When tokenAmount is specified, the system will calculate baseAmount from the pool price\n\nPATTERN RECOGNITION (EXTRACT THE NUMBER!):\n- \"Trade X SOL with TOKEN\" \u2192 baseAmount = X (extract X as a number!), tokenSymbol = \"TOKEN\", baseToken = \"SOL\", action = \"BUY\"\n- \"Trade X SOL with TOKENA\" \u2192 baseAmount = X (extract X as a number!), tokenSymbol = \"TOKENA\", baseToken = \"SOL\", action = \"BUY\"\n- \"Trade X SOL with TOKENB\" \u2192 baseAmount = X (extract X as a number!), tokenSymbol = \"TOKENB\", baseToken = \"SOL\", action = \"BUY\"\n- If user says \"Trade 2 SOL with TOKEN\", you MUST extract baseAmount = 2 (the number 2 is the quantity of SOL)\n\nIMPORTANT: In phrases like \"BUY 2 SOLANA token A\":\n- tokenSymbol = \"TOKENA\" (the token being bought)\n- baseToken = \"SOL\" (SOLANA/SOL is the currency used to buy)\n- tokenAmount = 2 (if \"2\" refers to tokens) OR baseAmount = 2 (if \"2\" refers to SOL - need context)\n\nExample: {\"query\": {\"serviceType\": \"dex\", \"filters\": {\"tokenSymbol\": \"TOKENA\", \"baseToken\": \"SOL\", \"action\": \"BUY\", \"tokenAmount\": 2, \"maxPrice\": 1}}, \"serviceType\": \"dex\", \"confidence\": 0.95}\nExample: {\"query\": {\"serviceType\": \"dex\", \"filters\": {\"tokenSymbol\": \"TOKEN\", \"baseToken\": \"SOL\", \"action\": \"BUY\", \"baseAmount\": 2}}, \"serviceType\": \"dex\", \"confidence\": 0.95}\n\n\uD83D\uDEA8 MANDATORY EXAMPLES - EXTRACT THE NUMBER CORRECTLY:\nExample for \"Trade 2 SOL with TOKEN\": {\"query\": {\"serviceType\": \"dex\", \"filters\": {\"tokenSymbol\": \"TOKEN\", \"baseToken\": \"SOL\", \"action\": \"BUY\", \"baseAmount\": 2}}, \"serviceType\": \"dex\", \"confidence\": 0.95}\n  * CRITICAL: The number \"2\" in \"Trade 2 SOL\" means baseAmount = 2 (user wants to spend 2 SOL)\n  * DO NOT set tokenAmount = 2, set baseAmount = 2!\nExample for \"Trade 2 SOL with TOKENA\": {\"query\": {\"serviceType\": \"dex\", \"filters\": {\"tokenSymbol\": \"TOKENA\", \"baseToken\": \"SOL\", \"action\": \"BUY\", \"baseAmount\": 2}}, \"serviceType\": \"dex\", \"confidence\": 0.95}\n  * CRITICAL: baseAmount = 2 (the number before \"SOL\" is always baseAmount)\nExample for \"Trade 2 SOL with TOKENB\": {\"query\": {\"serviceType\": \"dex\", \"filters\": {\"tokenSymbol\": \"TOKENB\", \"baseToken\": \"SOL\", \"action\": \"BUY\", \"baseAmount\": 2}}, \"serviceType\": \"dex\", \"confidence\": 0.95}\n  * CRITICAL: baseAmount = 2 (extract the number 2 as baseAmount)\nExample for \"Trade 5 SOL with TOKEN\": {\"query\": {\"serviceType\": \"dex\", \"filters\": {\"tokenSymbol\": \"TOKEN\", \"baseToken\": \"SOL\", \"action\": \"BUY\", \"baseAmount\": 5}}, \"serviceType\": \"dex\", \"confidence\": 0.95}\n  * CRITICAL: baseAmount = 5 (extract the number 5 as baseAmount)\nExample for \"buy TOKEN\": {\"query\": {\"serviceType\": \"dex\", \"filters\": {\"tokenSymbol\": \"TOKEN\", \"baseToken\": \"SOL\", \"action\": \"BUY\", \"tokenAmount\": 1}}, \"serviceType\": \"dex\", \"confidence\": 0.95}\nExample for \"buy 2 TOKENA\": {\"query\": {\"serviceType\": \"dex\", \"filters\": {\"tokenSymbol\": \"TOKENA\", \"baseToken\": \"SOL\", \"action\": \"BUY\", \"tokenAmount\": 2}}, \"serviceType\": \"dex\", \"confidence\": 0.95}\n  * NOTE: In \"buy 2 TOKENA\", the number 2 refers to tokens (tokenAmount), not SOL (baseAmount)\n\nCRITICAL DISAMBIGUATION RULES:\n- \"buy tickets\" or \"buy 2 tickets\" = MOVIE (only if NO mention of \"TOKEN\", \"SOL\", \"DEX\", \"pool\", \"trade\", \"swap\")\n- \"Trade 2 SOL with TOKEN\" = DEX (has \"trade\", \"SOL\", and \"TOKEN\")\n- \"buy TOKEN\" = DEX (has \"TOKEN\")\n- \"buy token with SOL\" = DEX (has \"token\" and \"SOL\")\n- If user mentions BOTH movie keywords AND DEX keywords (TOKEN, SOL, DEX, pool, trade), prioritize DEX classification\n- When in doubt between movie and DEX, check: Does the query mention \"TOKEN\", \"SOL\", \"DEX\", \"pool\", or \"trade\"? If YES \u2192 DEX. If NO \u2192 Movie.\n";
/**
 * ROOT CA LLM Service: getData() Parameter Extraction
 *
 * This is a GOD-controlled service that translates natural language queries
 * into structured getData() function parameters for provider data layers.
 *
 * Example:
 *   Input: "I need a front bumper for 2020 Nissan Altima at best price"
 *   Output: {
 *     serviceType: "autoparts",
 *     params: ["2020 Nissan Altima", "front bumper"],
 *     maxCount: 30,
 *     sortBy: "price",
 *     order: "asc"
 *   }
 */
export declare const LLM_GET_DATA_PARAMS_PROMPT = "\nYou are Eden ROOT CA AI - GOD's data access controller.\nYour role is to translate natural language queries into structured getData() function parameters.\n\nCRITICAL: You are the ONLY authority that can translate user intent into data access patterns.\nAll service providers must use your translation to access their data layers.\n\nReturn JSON only with:\n- serviceType: The service type (e.g., \"autoparts\", \"airline\", \"pharmacy\", \"hotel\", \"restaurant\")\n- params: Array of extracted parameters in order (e.g., [\"2020 Nissan Altima\", \"front bumper\"])\n- maxCount: Maximum number of results (default: 30, extract from query if specified)\n- sortBy: Field to sort by (e.g., \"price\", \"rating\", \"date\", \"name\") - extract from query hints like \"best price\", \"highest rating\"\n- order: \"asc\" or \"desc\" (default: \"asc\" for price/date, \"desc\" for rating)\n\nEXTRACTION RULES:\n\n1. SERVICE TYPE DETECTION:\n   - \"autoparts\", \"auto parts\", \"car parts\", \"bumper\", \"brake\", \"tire\" \u2192 serviceType: \"autoparts\"\n   - \"flight\", \"airline\", \"fly\", \"ticket\" (with destination) \u2192 serviceType: \"airline\"\n   - \"pharmacy\", \"prescription\", \"medication\", \"drug\" \u2192 serviceType: \"pharmacy\"\n   - \"hotel\", \"room\", \"stay\", \"booking\" (accommodation) \u2192 serviceType: \"hotel\"\n   - \"restaurant\", \"reservation\", \"dinner\", \"lunch\" \u2192 serviceType: \"restaurant\"\n   - \"movie\", \"cinema\", \"theater\" \u2192 serviceType: \"movie\"\n   - \"token\", \"DEX\", \"TOKENA\", \"TOKENB\" \u2192 serviceType: \"dex\"\n\n2. PARAMETER EXTRACTION:\n   - Extract key search terms (make/model, destination, medication name, etc.)\n   - Extract filters (year, location, date, etc.)\n   - Order params by importance (most specific first)\n   - Example: \"2020 Nissan Altima front bumper\" \u2192 params: [\"2020 Nissan Altima\", \"front bumper\"]\n   - Example: \"flight from New York to Los Angeles\" \u2192 params: [\"New York\", \"Los Angeles\"]\n\n3. SORTING HINTS:\n   - \"best price\", \"cheapest\", \"lowest price\" \u2192 sortBy: \"price\", order: \"asc\"\n   - \"highest rating\", \"best rated\" \u2192 sortBy: \"rating\", order: \"desc\"\n   - \"newest\", \"latest\" \u2192 sortBy: \"date\", order: \"desc\"\n   - \"best\", \"top\" (without qualifier) \u2192 sortBy: \"rating\", order: \"desc\"\n\n4. MAX COUNT:\n   - Extract if specified: \"top 10\", \"first 5\", \"show 20\"\n   - Default: 30\n\nEXAMPLES:\n\nInput: \"I need a front bumper for 2020 Nissan Altima at best price\"\nOutput: {\n  \"serviceType\": \"autoparts\",\n  \"params\": [\"2020 Nissan Altima\", \"front bumper\"],\n  \"maxCount\": 30,\n  \"sortBy\": \"price\",\n  \"order\": \"asc\"\n}\n\nInput: \"Find flights from New York to Los Angeles next week\"\nOutput: {\n  \"serviceType\": \"airline\",\n  \"params\": [\"New York\", \"Los Angeles\", \"next week\"],\n  \"maxCount\": 30,\n  \"sortBy\": \"price\",\n  \"order\": \"asc\"\n}\n\nInput: \"I need my prescription medication available\"\nOutput: {\n  \"serviceType\": \"pharmacy\",\n  \"params\": [\"prescription medication\"],\n  \"maxCount\": 30,\n  \"sortBy\": \"name\",\n  \"order\": \"asc\"\n}\n\nInput: \"Show me top 10 hotels in Paris with highest rating\"\nOutput: {\n  \"serviceType\": \"hotel\",\n  \"params\": [\"Paris\"],\n  \"maxCount\": 10,\n  \"sortBy\": \"rating\",\n  \"order\": \"desc\"\n}\n\nCRITICAL: Return ONLY valid JSON. No explanations, no markdown, just the JSON object.\n";
export type GetDataParamsResult = {
    serviceType: string;
    params: string[];
    maxCount: number;
    sortBy?: string;
    order?: "asc" | "desc";
    confidence: number;
};
export declare function extractGetDataParamsWithOpenAI(userInput: string): Promise<GetDataParamsResult>;
export declare function callLLM(prompt: string, useOpenAI?: boolean): Promise<string>;
export declare const LLM_RESPONSE_FORMATTING_PROMPT: any;
/**
 * Extract query from user input using OpenAI
 */
export declare function extractQueryWithOpenAI(userInput: string): Promise<LLMQueryResult>;
/**
 * Format response using OpenAI
 */
export declare function formatResponseWithOpenAI(listings: MovieListing[] | TokenListing[], userQuery: string, queryFilters?: {
    serviceType?: string;
    maxPrice?: number | string;
    genre?: string;
    time?: string;
    location?: string;
    tokenSymbol?: string;
    baseToken?: string;
    action?: 'BUY' | 'SELL';
    [key: string]: any;
}): Promise<LLMResponse>;
/**
 * Format response using DeepSeek (stub - full implementation can be added later)
 */
export declare function formatResponseWithDeepSeek(listings: MovieListing[] | TokenListing[], userQuery: string, queryFilters?: {
    serviceType?: string;
    maxPrice?: number | string;
    genre?: string;
    time?: string;
    location?: string;
    tokenSymbol?: string;
    baseToken?: string;
    action?: 'BUY' | 'SELL';
    [key: string]: any;
}): Promise<LLMResponse>;
export declare const LLM_SQL_PARAMETERIZATION_PROMPT = "\nYou are Eden ROOT CA AI - GOD's SQL security controller.\nYour role is to convert SQL queries with hardcoded values into parameterized queries (using ? placeholders) to prevent SQL injection.\n\nCRITICAL RULES:\n1. Replace ALL hardcoded values in WHERE clauses with ? placeholders\n2. Extract the parameter values in the EXACT order they appear in the query\n3. Keep static values (like status = 1, archived = 0, published = 1) as-is if they are constants\n4. For LIKE clauses with CONCAT, replace the search term with ? but keep the CONCAT structure\n5. Preserve the original SQL structure, formatting, and comments\n6. Return the parameterized SQL and the parameter array in order\n\nEXAMPLES:\n\nInput SQL:\nSELECT * FROM autoparts \nWHERE year = 2020\n  AND make = 'honda' \n  AND model = 'civic'\n  AND title LIKE CONCAT('%', 'bumper', '%') \n  AND status = 1\n  AND archived = 0 \n  AND published = 1\nORDER BY id DESC\nLIMIT 30 OFFSET 0\n\nOutput:\n{\n  \"parameterizedSql\": \"SELECT * FROM autoparts WHERE year = ? AND make = ? AND model = ? AND title LIKE CONCAT('%', ?, '%') AND status = 1 AND archived = 0 AND published = 1 ORDER BY id DESC LIMIT 30 OFFSET 0\",\n  \"params\": [2020, \"honda\", \"civic\", \"bumper\"],\n  \"paramOrder\": [\"year\", \"make\", \"model\", \"title\"],\n  \"confidence\": 1.0\n}\n\nInput SQL:\nSELECT * FROM products WHERE category = 'electronics' AND price > 100 AND name LIKE '%phone%'\n\nOutput:\n{\n  \"parameterizedSql\": \"SELECT * FROM products WHERE category = ? AND price > ? AND name LIKE ?\",\n  \"params\": [\"electronics\", 100, \"%phone%\"],\n  \"paramOrder\": [\"category\", \"price\", \"name\"],\n  \"confidence\": 1.0\n}\n\nCRITICAL: Return ONLY valid JSON. No explanations, no markdown, just the JSON object.\n";
export type SQLParameterizationResult = {
    parameterizedSql: string;
    params: any[];
    paramOrder: string[];
    confidence: number;
};
/**
 * Convert SQL query with hardcoded values to parameterized query using LLM
 */
export declare function parameterizeSQLWithOpenAI(sql: string): Promise<SQLParameterizationResult>;
//# sourceMappingURL=llm.d.ts.map