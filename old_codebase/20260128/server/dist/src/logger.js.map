{
  "version": 3,
  "sources": ["../../src/logger.ts"],
  "sourcesContent": ["/**\r\n * Simple JSON-based logger for tracing garden lifecycle\r\n * Stores events in a map and saves to JSON file\r\n */\r\n\r\nimport * as fs from 'fs';\r\nimport * as path from 'path';\r\n\r\ninterface LogEntry {\r\n  timestamp: number;\r\n  event: string;\r\n  data: any;\r\n}\r\n\r\nclass SimpleLogger {\r\n  private logFile: string;\r\n  private logs: Map<string, LogEntry[]> = new Map();\r\n  private saveInterval: NodeJS.Timeout | null = null;\r\n\r\n  constructor(logFileName: string = 'eden-garden-lifecycle.json') {\r\n    this.logFile = path.join(__dirname, '..', logFileName);\r\n    this.loadLogs();\r\n  }\r\n\r\n  /**\r\n   * Load existing logs from file\r\n   */\r\n  private loadLogs(): void {\r\n    try {\r\n      if (fs.existsSync(this.logFile)) {\r\n        const content = fs.readFileSync(this.logFile, 'utf-8');\r\n        const data = JSON.parse(content);\r\n        if (data.logs && typeof data.logs === 'object') {\r\n          for (const [key, value] of Object.entries(data.logs)) {\r\n            this.logs.set(key, value as LogEntry[]);\r\n          }\r\n        }\r\n      }\r\n    } catch (err: any) {\r\n      console.warn(`\u26A0\uFE0F  [Logger] Failed to load logs: ${err.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Log an event\r\n   */\r\n  log(category: string, event: string, data: any = {}): void {\r\n    const entry: LogEntry = {\r\n      timestamp: Date.now(),\r\n      event,\r\n      data\r\n    };\r\n\r\n    if (!this.logs.has(category)) {\r\n      this.logs.set(category, []);\r\n    }\r\n    this.logs.get(category)!.push(entry);\r\n\r\n    // Auto-save every 5 seconds\r\n    if (!this.saveInterval) {\r\n      this.saveInterval = setInterval(() => this.save(), 5000);\r\n    }\r\n\r\n    // Also save immediately for critical events\r\n    if (event.includes('create') || event.includes('save') || event.includes('error')) {\r\n      this.save();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Save logs to file\r\n   */\r\n  save(): void {\r\n    try {\r\n      const data = {\r\n        lastSaved: new Date().toISOString(),\r\n        logs: Object.fromEntries(this.logs)\r\n      };\r\n      fs.writeFileSync(this.logFile, JSON.stringify(data, null, 2), 'utf-8');\r\n    } catch (err: any) {\r\n      console.warn(`\u26A0\uFE0F  [Logger] Failed to save logs: ${err.message}`);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get logs for a category\r\n   */\r\n  getLogs(category: string): LogEntry[] {\r\n    return this.logs.get(category) || [];\r\n  }\r\n\r\n  /**\r\n   * Clear logs\r\n   */\r\n  clear(): void {\r\n    this.logs.clear();\r\n    this.save();\r\n  }\r\n}\r\n\r\n// Singleton instance\r\nlet loggerInstance: SimpleLogger | null = null;\r\n\r\n/**\r\n * Initialize the logger\r\n */\r\nexport function initializeLogger(): SimpleLogger {\r\n  if (!loggerInstance) {\r\n    loggerInstance = new SimpleLogger();\r\n    console.log(`\uD83D\uDCDD [Logger] Initialized - logs will be saved to ${loggerInstance['logFile']}`);\r\n  }\r\n  return loggerInstance;\r\n}\r\n\r\n/**\r\n * Get the logger instance\r\n */\r\nexport function getLogger(): SimpleLogger {\r\n  if (!loggerInstance) {\r\n    return initializeLogger();\r\n  }\r\n  return loggerInstance;\r\n}\r\n\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA,SAAoB;AACpB,WAAsB;AAQtB,MAAM,aAAa;AAAA,EAKjB,YAAY,cAAsB,8BAA8B;AAHhE,SAAQ,OAAgC,oBAAI,IAAI;AAChD,SAAQ,eAAsC;AAG5C,SAAK,UAAU,KAAK,KAAK,WAAW,MAAM,WAAW;AACrD,SAAK,SAAS;AAAA,EAChB;AAAA;AAAA;AAAA;AAAA,EAKQ,WAAiB;AACvB,QAAI;AACF,UAAI,GAAG,WAAW,KAAK,OAAO,GAAG;AAC/B,cAAM,UAAU,GAAG,aAAa,KAAK,SAAS,OAAO;AACrD,cAAM,OAAO,KAAK,MAAM,OAAO;AAC/B,YAAI,KAAK,QAAQ,OAAO,KAAK,SAAS,UAAU;AAC9C,qBAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,KAAK,IAAI,GAAG;AACpD,iBAAK,KAAK,IAAI,KAAK,KAAmB;AAAA,UACxC;AAAA,QACF;AAAA,MACF;AAAA,IACF,SAAS,KAAU;AACjB,cAAQ,KAAK,+CAAqC,IAAI,OAAO,EAAE;AAAA,IACjE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,UAAkB,OAAe,OAAY,CAAC,GAAS;AACzD,UAAM,QAAkB;AAAA,MACtB,WAAW,KAAK,IAAI;AAAA,MACpB;AAAA,MACA;AAAA,IACF;AAEA,QAAI,CAAC,KAAK,KAAK,IAAI,QAAQ,GAAG;AAC5B,WAAK,KAAK,IAAI,UAAU,CAAC,CAAC;AAAA,IAC5B;AACA,SAAK,KAAK,IAAI,QAAQ,EAAG,KAAK,KAAK;AAGnC,QAAI,CAAC,KAAK,cAAc;AACtB,WAAK,eAAe,YAAY,MAAM,KAAK,KAAK,GAAG,GAAI;AAAA,IACzD;AAGA,QAAI,MAAM,SAAS,QAAQ,KAAK,MAAM,SAAS,MAAM,KAAK,MAAM,SAAS,OAAO,GAAG;AACjF,WAAK,KAAK;AAAA,IACZ;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAa;AACX,QAAI;AACF,YAAM,OAAO;AAAA,QACX,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,QAClC,MAAM,OAAO,YAAY,KAAK,IAAI;AAAA,MACpC;AACA,SAAG,cAAc,KAAK,SAAS,KAAK,UAAU,MAAM,MAAM,CAAC,GAAG,OAAO;AAAA,IACvE,SAAS,KAAU;AACjB,cAAQ,KAAK,+CAAqC,IAAI,OAAO,EAAE;AAAA,IACjE;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,QAAQ,UAA8B;AACpC,WAAO,KAAK,KAAK,IAAI,QAAQ,KAAK,CAAC;AAAA,EACrC;AAAA;AAAA;AAAA;AAAA,EAKA,QAAc;AACZ,SAAK,KAAK,MAAM;AAChB,SAAK,KAAK;AAAA,EACZ;AACF;AAGA,IAAI,iBAAsC;AAKnC,SAAS,mBAAiC;AAC/C,MAAI,CAAC,gBAAgB;AACnB,qBAAiB,IAAI,aAAa;AAClC,YAAQ,IAAI,0DAAmD,eAAe,SAAS,CAAC,EAAE;AAAA,EAC5F;AACA,SAAO;AACT;AAKO,SAAS,YAA0B;AACxC,MAAI,CAAC,gBAAgB;AACnB,WAAO,iBAAiB;AAAA,EAC1B;AACA,SAAO;AACT;",
  "names": []
}
