{
  "serviceType": "DEX",
  "location": {
    "address": {
      "street": "123 Main Street",
      "city": "Springfield",
      "state": "IL",
      "zipCode": "62701",
      "country": "USA"
    },
    "openingHours": {
      "monday": {
        "open": "09:00",
        "close": "17:00"
      },
      "tuesday": {
        "open": "09:00",
        "close": "17:00"
      },
      "wednesday": {
        "open": "09:00",
        "close": "17:00"
      },
      "thursday": {
        "open": "09:00",
        "close": "17:00"
      },
      "friday": {
        "open": "09:00",
        "close": "17:00"
      },
      "saturday": {
        "open": "10:00",
        "close": "14:00"
      },
      "sunday": {
        "closed": true
      }
    },
    "phone": "(555) 000-0000"
  },
  "management": {
    "owner": {
      "ownerId": "owner_001",
      "name": "Business Owner",
      "email": "owner@business.com",
      "phone": "(555) 000-0000",
      "role": "owner",
      "ownershipPercentage": 100,
      "joinedDate": "2020-01-01"
    },
    "businessMetrics": {
      "monthlyRevenue": 30000,
      "monthlyExpenses": 20000,
      "totalCustomers": 100,
      "activeStaff": 5,
      "inventoryValue": 15000
    },
    "inventory": [
      {
        "id": "inv_001",
        "name": "Item 1",
        "quantity": 50,
        "unitPrice": 10,
        "category": "General"
      }
    ],
    "recentTransactions": [
      {
        "id": "txn_001",
        "date": "2024-01-15",
        "type": "sale",
        "amount": 100,
        "description": "Service provided"
      }
    ],
    "forms": {
      "addInventory": {
        "fields": [
          {
            "name": "name",
            "type": "text",
            "label": "Item Name",
            "required": true
          },
          {
            "name": "quantity",
            "type": "number",
            "label": "Quantity",
            "required": true
          },
          {
            "name": "unitPrice",
            "type": "number",
            "label": "Unit Price",
            "required": true
          },
          {
            "name": "category",
            "type": "select",
            "label": "Category",
            "required": true,
            "options": [
              "General",
              "Equipment",
              "Supplies"
            ]
          }
        ]
      },
      "recordTransaction": {
        "fields": [
          {
            "name": "date",
            "type": "date",
            "label": "Date",
            "required": true
          },
          {
            "name": "type",
            "type": "select",
            "label": "Type",
            "required": true,
            "options": [
              "sale",
              "purchase",
              "expense"
            ]
          },
          {
            "name": "amount",
            "type": "number",
            "label": "Amount",
            "required": true
          },
          {
            "name": "description",
            "type": "textarea",
            "label": "Description",
            "required": true
          }
        ]
      },
      "updateMetrics": {
        "fields": [
          {
            "name": "monthlyRevenue",
            "type": "number",
            "label": "Monthly Revenue",
            "required": true
          },
          {
            "name": "monthlyExpenses",
            "type": "number",
            "label": "Monthly Expenses",
            "required": true
          },
          {
            "name": "totalCustomers",
            "type": "number",
            "label": "Total Customers",
            "required": false
          },
          {
            "name": "activeStaff",
            "type": "number",
            "label": "Active Staff",
            "required": false
          }
        ]
      },
      "editOwner": {
        "fields": [
          {
            "name": "name",
            "type": "text",
            "label": "Owner Name",
            "required": true
          },
          {
            "name": "email",
            "type": "text",
            "label": "Email",
            "required": true
          },
          {
            "name": "phone",
            "type": "text",
            "label": "Phone",
            "required": false
          }
        ]
      }
    },
    "ui": {
      "layout": "grid",
      "sections": [
        {
          "id": "owner",
          "title": "Owner Information",
          "type": "owner",
          "fields": [
            {
              "name": "name",
              "type": "text",
              "label": "Owner Name",
              "required": true
            },
            {
              "name": "email",
              "type": "text",
              "label": "Email",
              "required": true
            },
            {
              "name": "phone",
              "type": "text",
              "label": "Phone",
              "required": false
            }
          ]
        },
        {
          "id": "metrics",
          "title": "Business Metrics",
          "type": "metrics",
          "fields": [
            {
              "name": "monthlyRevenue",
              "type": "number",
              "label": "Monthly Revenue",
              "required": true
            },
            {
              "name": "monthlyExpenses",
              "type": "number",
              "label": "Monthly Expenses",
              "required": true
            }
          ]
        }
      ]
    }
  },
  "flowwiseWorkflow": {
    "name": "DEX Garden Chat Lifecycle",
    "version": "1.0.0",
    "description": "Complete FlowWise workflow for DEX garden chat interactions with ledger, cashier, LLM, payment, and notification control",
    "steps": [
      {
        "id": "user_input",
        "name": "1Ô∏è‚É£ User Input",
        "type": "input",
        "component": "user",
        "description": "Receive and validate user chat input for DEX trade",
        "actions": [
          {
            "type": "validate",
            "field": "input",
            "required": true
          },
          {
            "type": "validate",
            "field": "email",
            "required": true,
            "format": "email"
          }
        ],
        "websocketEvents": [
          {
            "type": "user_input",
            "component": "user",
            "message": "User query received",
            "data": {
              "input": "{{input}}",
              "email": "{{email}}"
            }
          }
        ],
        "outputs": {
          "input": "{{input}}",
          "email": "{{email}}",
          "user": "{{user}}"
        }
      },
      {
        "id": "llm_resolution",
        "name": "2Ô∏è‚É£ LLM Resolution",
        "type": "process",
        "component": "llm",
        "description": "Extract DEX trade query, query service registry, get token pools, format response",
        "actions": [
          {
            "type": "llm_extract_query",
            "provider": "openai",
            "input": "{{input}}"
          },
          {
            "type": "query_dex_pools",
            "tokenSymbol": "{{queryResult.query.filters.tokenSymbol}}",
            "baseToken": "{{queryResult.query.filters.baseToken}}",
            "action": "{{queryResult.query.filters.action}}"
          },
          {
            "type": "llm_format_response",
            "provider": "openai",
            "listings": "{{listings}}",
            "userQuery": "{{input}}"
          }
        ],
        "websocketEvents": [
          {
            "type": "llm_start",
            "component": "llm",
            "message": "Starting LLM query extraction...",
            "data": {}
          },
          {
            "type": "llm_response",
            "component": "llm",
            "message": "{{llmResponse.message}}",
            "data": {
              "response": "{{llmResponse}}"
            }
          },
          {
            "type": "igas",
            "component": "igas",
            "message": "iGas Cost: {{llmResponse.iGasCost}}",
            "data": {
              "igas": "{{llmResponse.iGasCost}}"
            }
          }
        ],
        "outputs": {
          "llmResponse": "{{llmResponse}}",
          "selectedListing": "{{llmResponse.selectedListing}}",
          "iGasCost": "{{llmResponse.iGasCost}}",
          "action": "{{action}}",
          "tokenAmount": "{{tokenAmount}}"
        },
        "errorHandling": {
          "onError": "error_handler",
          "errorEvents": [
            {
              "type": "error",
              "component": "llm",
              "message": "{{error.message}}"
            }
          ]
        }
      },
      {
        "id": "execute_dex_trade",
        "name": "3Ô∏è‚É£ Execute DEX Trade (Order System)",
        "type": "process",
        "component": "dex",
        "description": "Create DEX order, match using Order Service, and execute with two-phase settlement",
        "actions": [
          {
            "type": "check_balance",
            "email": "{{user.email}}",
            "required": "{{totalCost}}",
            "action": "{{action}}"
          },
          {
            "type": "execute_dex_trade",
            "action": "{{action}}",
            "tokenAmount": "{{tokenAmount}}",
            "userEmail": "{{user.email}}",
            "matchingModel": "AMM",
            "orderType": "MARKET"
          }
        ],
        "websocketEvents": [
          {
            "type": "dex_order_created",
            "component": "dex",
            "message": "DEX order created: {{dexOrder.orderId}}",
            "data": {
              "order": "{{dexOrder}}",
              "action": "{{action}}",
              "tokenAmount": "{{tokenAmount}}",
              "tokenSymbol": "{{tokenSymbol}}"
            }
          },
          {
            "type": "dex_trade_executed",
            "component": "dex",
            "message": "DEX trade executed: {{action}} {{tokenAmount}} {{tokenSymbol}} at {{trade.price}}",
            "data": {
              "trade": "{{trade}}",
              "order": "{{dexOrder}}",
              "settlement": "{{dexSettlement}}"
            }
          },
          {
            "type": "dex_price_update",
            "component": "dex",
            "message": "Price updated: {{trade.price}}",
            "data": {
              "pair": "{{tokenSymbol}}/{{baseToken}}",
              "price": "{{trade.price}}"
            }
          }
        ],
        "outputs": {
          "order": "{{dexOrder}}",
          "trade": "{{trade}}",
          "settlement": "{{dexSettlement}}",
          "matchResult": "{{dexMatchResult}}",
          "updatedBalance": "{{user.balance}}"
        },
        "errorHandling": {
          "onError": "error_handler",
          "errorEvents": [
            {
              "type": "insufficient_balance",
              "component": "wallet",
              "message": "Insufficient balance for DEX trade"
            }
          ]
        }
      },
      {
        "id": "user_confirm_trade",
        "name": "ü§î User Decision: Confirm Trade",
        "type": "decision",
        "component": "user",
        "description": "Ask user to confirm the selected DEX trade before execution",
        "requiresUserDecision": true,
        "decisionPrompt": "Would you like to proceed with {{action}} {{tokenAmount}} {{tokenSymbol}} for ~{{selectedListing.price}} {{baseToken}}?",
        "decisionOptions": [
          {
            "value": "YES",
            "label": "Yes, execute trade",
            "action": "continue"
          },
          {
            "value": "NO",
            "label": "No, cancel",
            "action": "cancel"
          }
        ],
        "websocketEvents": [
          {
            "type": "user_decision_required",
            "component": "user",
            "message": "Please confirm your DEX trade",
            "data": {
              "decisionId": "confirm_trade",
              "prompt": "Would you like to proceed with {{action}} {{tokenAmount}} {{tokenSymbol}} for ~{{selectedListing.price}} {{baseToken}}?",
              "options": [
                {"value": "YES", "label": "Yes, execute trade"},
                {"value": "NO", "label": "No, cancel"}
              ],
              "timeout": 30000
            }
          }
        ],
        "outputs": {
          "userDecision": "{{userDecision}}"
        },
        "timeout": 30000,
        "onTimeout": "error_handler"
      },
      {
        "id": "complete_trade",
        "name": "5Ô∏è‚É£ Complete Trade",
        "type": "process",
        "component": "dex",
        "description": "Complete DEX trade and deliver notifications",
        "actions": [
          {
            "type": "process_payment",
            "ledgerEntry": "{{ledgerEntry}}",
            "amount": "{{trade.baseAmount}}"
          },
          {
            "type": "root_ca_validate_payment",
            "ledgerEntry": "{{ledgerEntry}}",
            "paymentResult": "{{paymentSuccess}}",
            "cashier": "{{cashier}}"
          },
          {
            "type": "root_ca_authorize_payment",
            "ledgerEntry": "{{ledgerEntry}}",
            "paymentStatus": "{{paymentSuccess}}"
          },
          {
            "type": "root_ca_consume_ledger",
            "ledgerEntry": "{{ledgerEntry}}"
          },
          {
            "type": "root_ca_validate_entry",
            "ledgerEntry": "{{ledgerEntry}}",
            "certificate": "{{providerUuid}}"
          },
          {
            "type": "root_ca_settle_entry",
            "ledgerEntry": "{{ledgerEntry}}"
          },
          {
            "type": "root_ca_update_balances",
            "ledgerEntry": "{{ledgerEntry}}",
            "feeSplit": "{{snapshot.feeSplit}}"
          },
          {
            "type": "root_ca_finalize_fees",
            "ledgerEntry": "{{ledgerEntry}}",
            "fees": "{{snapshot.feeSplit}}"
          },
          {
            "type": "complete_booking",
            "ledgerEntry": "{{ledgerEntry}}"
          },
          {
            "type": "persist_snapshot",
            "snapshot": "{{snapshot}}"
          },
          {
            "type": "stream_to_indexers",
            "snapshot": "{{snapshot}}"
          }
        ],
        "websocketEvents": [
          {
            "type": "dex_trade_complete",
            "component": "dex",
            "message": "DEX Trade Complete: {{action}} {{tokenAmount}} {{tokenSymbol}}",
            "data": {
              "trade": "{{trade}}",
              "userBalance": "{{user.balance}}"
            }
          }
        ],
        "outputs": {
          "completed": true
        }
      },
      {
        "id": "summary",
        "name": "6Ô∏è‚É£ Summary",
        "type": "output",
        "component": "transaction",
        "description": "Generate DEX trade summary",
        "websocketEvents": [
          {
            "type": "summary",
            "component": "transaction",
            "message": "DEX trade completed successfully",
            "data": {
              "action": "{{action}}",
              "tokenAmount": "{{tokenAmount}}",
              "tokenSymbol": "{{tokenSymbol}}",
              "baseAmount": "{{trade.baseAmount}}",
              "baseToken": "{{baseToken}}",
              "price": "{{trade.price}}",
              "iTax": "{{trade.iTax}}",
              "userBalance": "{{user.balance}}"
            }
          }
        ],
        "outputs": {
          "summary": "{{summary}}"
        }
      },
      {
        "id": "error_handler",
        "name": "Error Handler",
        "type": "error",
        "component": "system",
        "description": "Handle errors and broadcast error events",
        "websocketEvents": [
          {
            "type": "error",
            "component": "{{error.component}}",
            "message": "{{error.message}}",
            "data": {
              "error": "{{error}}"
            }
          }
        ]
      }
    ],
    "transitions": [
      {
        "from": "user_input",
        "to": "llm_resolution",
        "condition": "always"
      },
      {
        "from": "llm_resolution",
        "to": "user_confirm_trade",
        "condition": "{{llmResponse.selectedListing}}"
      },
      {
        "from": "llm_resolution",
        "to": "error_handler",
        "condition": "!{{llmResponse.selectedListing}}"
      },
      {
        "from": "user_confirm_trade",
        "to": "execute_dex_trade",
        "condition": "{{userDecision}} === 'YES'"
      },
      {
        "from": "user_confirm_trade",
        "to": "error_handler",
        "condition": "{{userDecision}} === 'NO'"
      },
      {
        "from": "execute_dex_trade",
        "to": "complete_trade",
        "condition": "{{trade}}"
      },
      {
        "from": "execute_dex_trade",
        "to": "error_handler",
        "condition": "!{{trade}}"
      },
      {
        "from": "complete_trade",
        "to": "summary",
        "condition": "always"
      }
    ],
    "initialStep": "user_input",
    "finalSteps": ["summary", "error_handler"]
  },
  "workflow": {
    "steps": [
      {
        "id": "start",
        "name": "Start",
        "type": "input",
        "description": "Service request initiated"
      },
      {
        "id": "process",
        "name": "Process",
        "type": "process",
        "description": "Processing request"
      },
      {
        "id": "complete",
        "name": "Complete",
        "type": "output",
        "description": "Service completed"
      }
    ],
    "transitions": [
      {
        "from": "start",
        "to": "process"
      },
      {
        "from": "process",
        "to": "complete"
      }
    ]
  },
  "dataStructures": {
    "Request": {
      "id": "string",
      "type": "string",
      "status": "string",
      "timestamp": "date"
    }
  },
  "forms": {
    "requestForm": {
      "fields": [
        {
          "name": "type",
          "type": "text",
          "label": "Request Type",
          "required": true
        },
        {
          "name": "description",
          "type": "textarea",
          "label": "Description",
          "required": true
        }
      ]
    }
  },
  "lifecycle": {
    "states": [
      "pending",
      "processing",
      "completed"
    ],
    "transitions": {
      "pending": [
        "processing"
      ],
      "processing": [
        "completed"
      ]
    },
    "initial": "pending",
    "final": [
      "completed"
    ]
  },
  "users": [
    {
      "userId": "user_001",
      "email": "bill.draper.auto@gmail.com",
      "name": "Bill Draper",
      "phone": "+1-555-0101",
      "address": "123 Madison Avenue, New York, NY 10022",
      "dateOfBirth": "1965-03-15",
      "role": "primary",
      "status": "active",
      "createdAt": "2026-01-02T02:13:09.992Z"
    }
  ],
  "primaryUser": {
    "userId": "user_001",
    "email": "bill.draper.auto@gmail.com",
    "name": "Bill Draper",
    "phone": "+1-555-0101",
    "address": "123 Madison Avenue, New York, NY 10022",
    "dateOfBirth": "1965-03-15",
    "role": "primary",
    "status": "active",
    "createdAt": "2026-01-02T02:13:09.992Z"
  },
  "employees": [
    {
      "id": "emp_001",
      "name": "Manager",
      "role": "Manager",
      "position": {
        "area": "office",
        "x": 50,
        "y": 30
      },
      "status": "available"
    },
    {
      "id": "emp_002",
      "name": "Server",
      "role": "Server",
      "position": {
        "area": "counter",
        "x": 40,
        "y": 40
      },
      "status": "available"
    },
    {
      "id": "emp_003",
      "name": "Cashier",
      "role": "Cashier",
      "position": {
        "area": "counter",
        "x": 60,
        "y": 40
      },
      "status": "busy"
    }
  ]
}